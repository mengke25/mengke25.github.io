citycode <- function(df_name, city_variable) {
  # 获取数据框
  df <- get(df_name)
  
  # 创建新的citycode变量并初始化为0
  df$citycode <- 0
  
  # 使用条件语句根据城市名变量更新citycode
  df$citycode[grep("北京", df[[city_variable]], ignore.case = TRUE)] <- "北京"
  df$citycode[grep("天津", df[[city_variable]], ignore.case = TRUE)] <- "天津"
  df$citycode[grep("石家庄", df[[city_variable]], ignore.case = TRUE)] <- "石家庄"
  df$citycode[grep("唐山", df[[city_variable]], ignore.case = TRUE)] <- "唐山"
  df$citycode[grep("秦皇岛", df[[city_variable]], ignore.case = TRUE)] <- "秦皇岛"
  df$citycode[grep("邯郸", df[[city_variable]], ignore.case = TRUE)] <- "邯郸"
  df$citycode[grep("邢台", df[[city_variable]], ignore.case = TRUE)] <- "邢台"
  df$citycode[grep("保定", df[[city_variable]], ignore.case = TRUE)] <- "保定"
  df$citycode[grep("张家口", df[[city_variable]], ignore.case = TRUE)] <- "张家口"
  df$citycode[grep("承德", df[[city_variable]], ignore.case = TRUE)] <- "承德"
  df$citycode[grep("沧州", df[[city_variable]], ignore.case = TRUE)] <- "沧州"
  df$citycode[grep("廊坊", df[[city_variable]], ignore.case = TRUE)] <- "廊坊"
  df$citycode[grep("衡水", df[[city_variable]], ignore.case = TRUE)] <- "衡水"
  df$citycode[grep("太原", df[[city_variable]], ignore.case = TRUE)] <- "太原"
  df$citycode[grep("大同", df[[city_variable]], ignore.case = TRUE)] <- "大同"
  df$citycode[grep("阳泉", df[[city_variable]], ignore.case = TRUE)] <- "阳泉"
  df$citycode[grep("长治", df[[city_variable]], ignore.case = TRUE)] <- "长治"
  df$citycode[grep("晋城", df[[city_variable]], ignore.case = TRUE)] <- "晋城"
  df$citycode[grep("朔州", df[[city_variable]], ignore.case = TRUE)] <- "朔州"
  df$citycode[grep("晋中", df[[city_variable]], ignore.case = TRUE)] <- "晋中"
  df$citycode[grep("运城", df[[city_variable]], ignore.case = TRUE)] <- "运城"
  df$citycode[grep("忻州", df[[city_variable]], ignore.case = TRUE)] <- "忻州"
  df$citycode[grep("临汾", df[[city_variable]], ignore.case = TRUE)] <- "临汾"
  df$citycode[grep("吕梁", df[[city_variable]], ignore.case = TRUE)] <- "吕梁"
  df$citycode[grep("呼和浩", df[[city_variable]], ignore.case = TRUE)] <- "呼和浩特"
  df$citycode[grep("包头", df[[city_variable]], ignore.case = TRUE)] <- "包头"
  df$citycode[grep("乌海", df[[city_variable]], ignore.case = TRUE)] <- "乌海"
  df$citycode[grep("赤峰", df[[city_variable]], ignore.case = TRUE)] <- "赤峰"
  df$citycode[grep("通辽", df[[city_variable]], ignore.case = TRUE)] <- "通辽"
  df$citycode[grep("鄂尔多", df[[city_variable]], ignore.case = TRUE)] <- "鄂尔多斯"
  df$citycode[grep("呼伦贝", df[[city_variable]], ignore.case = TRUE)] <- "呼伦贝尔"
  df$citycode[grep("巴彦淖", df[[city_variable]], ignore.case = TRUE)] <- "巴彦淖尔"
  df$citycode[grep("巴音郭", df[[city_variable]], ignore.case = TRUE)] <- "巴音郭楞"
  df$citycode[grep("乌兰察", df[[city_variable]], ignore.case = TRUE)] <- "乌兰察布"
  df$citycode[grep("沈阳", df[[city_variable]], ignore.case = TRUE)] <- "沈阳"
  df$citycode[grep("大连", df[[city_variable]], ignore.case = TRUE)] <- "大连"
  df$citycode[grep("鞍山", df[[city_variable]], ignore.case = TRUE)] <- "鞍山"
  df$citycode[grep("抚顺", df[[city_variable]], ignore.case = TRUE)] <- "抚顺"
  df$citycode[grep("本溪", df[[city_variable]], ignore.case = TRUE)] <- "本溪"
  df$citycode[grep("丹东", df[[city_variable]], ignore.case = TRUE)] <- "丹东"
  df$citycode[grep("锦州", df[[city_variable]], ignore.case = TRUE)] <- "锦州"
  df$citycode[grep("营口", df[[city_variable]], ignore.case = TRUE)] <- "营口"
  df$citycode[grep("阜新", df[[city_variable]], ignore.case = TRUE)] <- "阜新"
  df$citycode[grep("辽阳", df[[city_variable]], ignore.case = TRUE)] <- "辽阳"
  df$citycode[grep("盘锦", df[[city_variable]], ignore.case = TRUE)] <- "盘锦"
  df$citycode[grep("铁岭", df[[city_variable]], ignore.case = TRUE)] <- "铁岭"
  df$citycode[grep("朝阳", df[[city_variable]], ignore.case = TRUE)] <- "朝阳"
  df$citycode[grep("葫芦岛", df[[city_variable]], ignore.case = TRUE)] <- "葫芦岛"
  df$citycode[grep("长春", df[[city_variable]], ignore.case = TRUE)] <- "长春"
  df$citycode[grep("吉林", df[[city_variable]], ignore.case = TRUE)] <- "吉林"
  df$citycode[grep("四平", df[[city_variable]], ignore.case = TRUE)] <- "四平"
  df$citycode[grep("辽源", df[[city_variable]], ignore.case = TRUE)] <- "辽源"
  df$citycode[grep("通化", df[[city_variable]], ignore.case = TRUE)] <- "通化"
  df$citycode[grep("白山", df[[city_variable]], ignore.case = TRUE)] <- "白山"
  df$citycode[grep("松原", df[[city_variable]], ignore.case = TRUE)] <- "松原"
  df$citycode[grep("白城", df[[city_variable]], ignore.case = TRUE)] <- "白城"
  df$citycode[grep("哈尔滨", df[[city_variable]], ignore.case = TRUE)] <- "哈尔滨"
  df$citycode[grep("齐齐哈", df[[city_variable]], ignore.case = TRUE)] <- "齐齐哈尔"
  df$citycode[grep("鸡西", df[[city_variable]], ignore.case = TRUE)] <- "鸡西"
  df$citycode[grep("鹤岗", df[[city_variable]], ignore.case = TRUE)] <- "鹤岗"
  df$citycode[grep("双鸭山", df[[city_variable]], ignore.case = TRUE)] <- "双鸭山"
  df$citycode[grep("大庆", df[[city_variable]], ignore.case = TRUE)] <- "大庆"
  df$citycode[grep("伊春", df[[city_variable]], ignore.case = TRUE)] <- "伊春"
  df$citycode[grep("佳木斯", df[[city_variable]], ignore.case = TRUE)] <- "佳木斯"
  df$citycode[grep("七台河", df[[city_variable]], ignore.case = TRUE)] <- "七台河"
  df$citycode[grep("黑河", df[[city_variable]], ignore.case = TRUE)] <- "黑河"
  df$citycode[grep("绥化", df[[city_variable]], ignore.case = TRUE)] <- "绥化"
  df$citycode[grep("上海", df[[city_variable]], ignore.case = TRUE)] <- "上海"
  df$citycode[grep("南京", df[[city_variable]], ignore.case = TRUE)] <- "南京"
  df$citycode[grep("无锡", df[[city_variable]], ignore.case = TRUE)] <- "无锡"
  df$citycode[grep("徐州", df[[city_variable]], ignore.case = TRUE)] <- "徐州"
  df$citycode[grep("常州", df[[city_variable]], ignore.case = TRUE)] <- "常州"
  df$citycode[grep("苏州", df[[city_variable]], ignore.case = TRUE)] <- "苏州"
  df$citycode[grep("南通", df[[city_variable]], ignore.case = TRUE)] <- "南通"
  df$citycode[grep("连云港", df[[city_variable]], ignore.case = TRUE)] <- "连云港"
  df$citycode[grep("淮安", df[[city_variable]], ignore.case = TRUE)] <- "淮安"
  df$citycode[grep("盐城", df[[city_variable]], ignore.case = TRUE)] <- "盐城"
  df$citycode[grep("扬州", df[[city_variable]], ignore.case = TRUE)] <- "扬州"
  df$citycode[grep("镇江", df[[city_variable]], ignore.case = TRUE)] <- "镇江"
  df$citycode[grep("泰州", df[[city_variable]], ignore.case = TRUE)] <- "泰州"
  df$citycode[grep("宿迁", df[[city_variable]], ignore.case = TRUE)] <- "宿迁"
  df$citycode[grep("杭州", df[[city_variable]], ignore.case = TRUE)] <- "杭州"
  df$citycode[grep("宁波", df[[city_variable]], ignore.case = TRUE)] <- "宁波"
  df$citycode[grep("温州", df[[city_variable]], ignore.case = TRUE)] <- "温州"
  df$citycode[grep("嘉兴", df[[city_variable]], ignore.case = TRUE)] <- "嘉兴"
  df$citycode[grep("湖州", df[[city_variable]], ignore.case = TRUE)] <- "湖州"
  df$citycode[grep("绍兴", df[[city_variable]], ignore.case = TRUE)] <- "绍兴"
  df$citycode[grep("金华", df[[city_variable]], ignore.case = TRUE)] <- "金华"
  df$citycode[grep("衢州", df[[city_variable]], ignore.case = TRUE)] <- "衢州"
  df$citycode[grep("舟山", df[[city_variable]], ignore.case = TRUE)] <- "舟山"
  df$citycode[grep("台州", df[[city_variable]], ignore.case = TRUE)] <- "台州"
  df$citycode[grep("丽水", df[[city_variable]], ignore.case = TRUE)] <- "丽水"
  df$citycode[grep("合肥", df[[city_variable]], ignore.case = TRUE)] <- "合肥"
  df$citycode[grep("芜湖", df[[city_variable]], ignore.case = TRUE)] <- "芜湖"
  df$citycode[grep("蚌埠", df[[city_variable]], ignore.case = TRUE)] <- "蚌埠"
  df$citycode[grep("淮南", df[[city_variable]], ignore.case = TRUE)] <- "淮南"
  df$citycode[grep("马鞍山", df[[city_variable]], ignore.case = TRUE)] <- "马鞍山"
  df$citycode[grep("淮北", df[[city_variable]], ignore.case = TRUE)] <- "淮北"
  df$citycode[grep("铜陵", df[[city_variable]], ignore.case = TRUE)] <- "铜陵"
  df$citycode[grep("安庆", df[[city_variable]], ignore.case = TRUE)] <- "安庆"
  df$citycode[grep("黄山", df[[city_variable]], ignore.case = TRUE)] <- "黄山"
  df$citycode[grep("滁州", df[[city_variable]], ignore.case = TRUE)] <- "滁州"
  df$citycode[grep("阜阳", df[[city_variable]], ignore.case = TRUE)] <- "阜阳"
  df$citycode[grep("宿州", df[[city_variable]], ignore.case = TRUE)] <- "宿州"
  df$citycode[grep("巢湖", df[[city_variable]], ignore.case = TRUE)] <- "巢湖"
  df$citycode[grep("六安", df[[city_variable]], ignore.case = TRUE)] <- "六安"
  df$citycode[grep("亳州", df[[city_variable]], ignore.case = TRUE)] <- "亳州"
  df$citycode[grep("池州", df[[city_variable]], ignore.case = TRUE)] <- "池州"
  df$citycode[grep("宣城", df[[city_variable]], ignore.case = TRUE)] <- "宣城"
  df$citycode[grep("福州", df[[city_variable]], ignore.case = TRUE)] <- "福州"
  df$citycode[grep("厦门", df[[city_variable]], ignore.case = TRUE)] <- "厦门"
  df$citycode[grep("莆田", df[[city_variable]], ignore.case = TRUE)] <- "莆田"
  df$citycode[grep("三明", df[[city_variable]], ignore.case = TRUE)] <- "三明"
  df$citycode[grep("泉州", df[[city_variable]], ignore.case = TRUE)] <- "泉州"
  df$citycode[grep("漳州", df[[city_variable]], ignore.case = TRUE)] <- "漳州"
  df$citycode[grep("南平", df[[city_variable]], ignore.case = TRUE)] <- "南平"
  df$citycode[grep("龙岩", df[[city_variable]], ignore.case = TRUE)] <- "龙岩"
  df$citycode[grep("宁德", df[[city_variable]], ignore.case = TRUE)] <- "宁德"
  df$citycode[grep("南昌", df[[city_variable]], ignore.case = TRUE)] <- "南昌"
  df$citycode[grep("景德镇", df[[city_variable]], ignore.case = TRUE)] <- "景德镇"
  df$citycode[grep("萍乡", df[[city_variable]], ignore.case = TRUE)] <- "萍乡"
  df$citycode[grep("九江", df[[city_variable]], ignore.case = TRUE)] <- "九江"
  df$citycode[grep("新余", df[[city_variable]], ignore.case = TRUE)] <- "新余"
  df$citycode[grep("鹰潭", df[[city_variable]], ignore.case = TRUE)] <- "鹰潭"
  df$citycode[grep("赣州", df[[city_variable]], ignore.case = TRUE)] <- "赣州"
  df$citycode[grep("吉安", df[[city_variable]], ignore.case = TRUE)] <- "吉安"
  df$citycode[grep("宜春", df[[city_variable]], ignore.case = TRUE)] <- "宜春"
  df$citycode[grep("抚州", df[[city_variable]], ignore.case = TRUE)] <- "抚州"
  df$citycode[grep("上饶", df[[city_variable]], ignore.case = TRUE)] <- "上饶"
  df$citycode[grep("济南", df[[city_variable]], ignore.case = TRUE)] <- "济南"
  df$citycode[grep("青岛", df[[city_variable]], ignore.case = TRUE)] <- "青岛"
  df$citycode[grep("淄博", df[[city_variable]], ignore.case = TRUE)] <- "淄博"
  df$citycode[grep("枣庄", df[[city_variable]], ignore.case = TRUE)] <- "枣庄"
  df$citycode[grep("东营", df[[city_variable]], ignore.case = TRUE)] <- "东营"
  df$citycode[grep("烟台", df[[city_variable]], ignore.case = TRUE)] <- "烟台"
  df$citycode[grep("潍坊", df[[city_variable]], ignore.case = TRUE)] <- "潍坊"
  df$citycode[grep("济宁", df[[city_variable]], ignore.case = TRUE)] <- "济宁"
  df$citycode[grep("泰安", df[[city_variable]], ignore.case = TRUE)] <- "泰安"
  df$citycode[grep("威海", df[[city_variable]], ignore.case = TRUE)] <- "威海"
  df$citycode[grep("日照", df[[city_variable]], ignore.case = TRUE)] <- "日照"
  df$citycode[grep("莱芜", df[[city_variable]], ignore.case = TRUE)] <- "莱芜"
  df$citycode[grep("临沂", df[[city_variable]], ignore.case = TRUE)] <- "临沂"
  df$citycode[grep("德州", df[[city_variable]], ignore.case = TRUE)] <- "德州"
  df$citycode[grep("聊城", df[[city_variable]], ignore.case = TRUE)] <- "聊城"
  df$citycode[grep("滨州", df[[city_variable]], ignore.case = TRUE)] <- "滨州"
  df$citycode[grep("菏泽", df[[city_variable]], ignore.case = TRUE)] <- "菏泽"
  df$citycode[grep("郑州", df[[city_variable]], ignore.case = TRUE)] <- "郑州"
  df$citycode[grep("开封", df[[city_variable]], ignore.case = TRUE)] <- "开封"
  df$citycode[grep("洛阳", df[[city_variable]], ignore.case = TRUE)] <- "洛阳"
  df$citycode[grep("平顶山", df[[city_variable]], ignore.case = TRUE)] <- "平顶山"
  df$citycode[grep("安阳", df[[city_variable]], ignore.case = TRUE)] <- "安阳"
  df$citycode[grep("鹤壁", df[[city_variable]], ignore.case = TRUE)] <- "鹤壁"
  df$citycode[grep("新乡", df[[city_variable]], ignore.case = TRUE)] <- "新乡"
  df$citycode[grep("焦作", df[[city_variable]], ignore.case = TRUE)] <- "焦作"
  df$citycode[grep("濮阳", df[[city_variable]], ignore.case = TRUE)] <- "濮阳"
  df$citycode[grep("许昌", df[[city_variable]], ignore.case = TRUE)] <- "许昌"
  df$citycode[grep("漯河", df[[city_variable]], ignore.case = TRUE)] <- "漯河"
  df$citycode[grep("三门峡", df[[city_variable]], ignore.case = TRUE)] <- "三门峡"
  df$citycode[grep("南阳", df[[city_variable]], ignore.case = TRUE)] <- "南阳"
  df$citycode[grep("商丘", df[[city_variable]], ignore.case = TRUE)] <- "商丘"
  df$citycode[grep("信阳", df[[city_variable]], ignore.case = TRUE)] <- "信阳"
  df$citycode[grep("周口", df[[city_variable]], ignore.case = TRUE)] <- "周口"
  df$citycode[grep("驻马店", df[[city_variable]], ignore.case = TRUE)] <- "驻马店"
  df$citycode[grep("武汉", df[[city_variable]], ignore.case = TRUE)] <- "武汉"
  df$citycode[grep("黄石", df[[city_variable]], ignore.case = TRUE)] <- "黄石"
  df$citycode[grep("十堰", df[[city_variable]], ignore.case = TRUE)] <- "十堰"
  df$citycode[grep("宜昌", df[[city_variable]], ignore.case = TRUE)] <- "宜昌"
  df$citycode[grep("襄阳", df[[city_variable]], ignore.case = TRUE)] <- "襄阳"
  df$citycode[grep("鄂州", df[[city_variable]], ignore.case = TRUE)] <- "鄂州"
  df$citycode[grep("荆门", df[[city_variable]], ignore.case = TRUE)] <- "荆门"
  df$citycode[grep("孝感", df[[city_variable]], ignore.case = TRUE)] <- "孝感"
  df$citycode[grep("荆州", df[[city_variable]], ignore.case = TRUE)] <- "荆州"
  df$citycode[grep("黄冈", df[[city_variable]], ignore.case = TRUE)] <- "黄冈"
  df$citycode[grep("咸宁", df[[city_variable]], ignore.case = TRUE)] <- "咸宁"
  df$citycode[grep("随州", df[[city_variable]], ignore.case = TRUE)] <- "随州"
  df$citycode[grep("长沙", df[[city_variable]], ignore.case = TRUE)] <- "长沙"
  df$citycode[grep("株洲", df[[city_variable]], ignore.case = TRUE)] <- "株洲"
  df$citycode[grep("湘潭", df[[city_variable]], ignore.case = TRUE)] <- "湘潭"
  df$citycode[grep("衡阳", df[[city_variable]], ignore.case = TRUE)] <- "衡阳"
  df$citycode[grep("邵阳", df[[city_variable]], ignore.case = TRUE)] <- "邵阳"
  df$citycode[grep("岳阳", df[[city_variable]], ignore.case = TRUE)] <- "岳阳"
  df$citycode[grep("常德", df[[city_variable]], ignore.case = TRUE)] <- "常德"
  df$citycode[grep("张家界", df[[city_variable]], ignore.case = TRUE)] <- "张家界"
  df$citycode[grep("益阳", df[[city_variable]], ignore.case = TRUE)] <- "益阳"
  df$citycode[grep("郴州", df[[city_variable]], ignore.case = TRUE)] <- "郴州"
  df$citycode[grep("永州", df[[city_variable]], ignore.case = TRUE)] <- "永州"
  df$citycode[grep("怀化", df[[city_variable]], ignore.case = TRUE)] <- "怀化"
  df$citycode[grep("娄底", df[[city_variable]], ignore.case = TRUE)] <- "娄底"
  df$citycode[grep("广州", df[[city_variable]], ignore.case = TRUE)] <- "广州"
  df$citycode[grep("韶关", df[[city_variable]], ignore.case = TRUE)] <- "韶关"
  df$citycode[grep("深圳", df[[city_variable]], ignore.case = TRUE)] <- "深圳"
  df$citycode[grep("珠海", df[[city_variable]], ignore.case = TRUE)] <- "珠海"
  df$citycode[grep("汕头", df[[city_variable]], ignore.case = TRUE)] <- "汕头"
  df$citycode[grep("佛山", df[[city_variable]], ignore.case = TRUE)] <- "佛山"
  df$citycode[grep("江门", df[[city_variable]], ignore.case = TRUE)] <- "江门"
  df$citycode[grep("湛江", df[[city_variable]], ignore.case = TRUE)] <- "湛江"
  df$citycode[grep("茂名", df[[city_variable]], ignore.case = TRUE)] <- "茂名"
  df$citycode[grep("肇庆", df[[city_variable]], ignore.case = TRUE)] <- "肇庆"
  df$citycode[grep("惠州", df[[city_variable]], ignore.case = TRUE)] <- "惠州"
  df$citycode[grep("梅州", df[[city_variable]], ignore.case = TRUE)] <- "梅州"
  df$citycode[grep("汕尾", df[[city_variable]], ignore.case = TRUE)] <- "汕尾"
  df$citycode[grep("河源", df[[city_variable]], ignore.case = TRUE)] <- "河源"
  df$citycode[grep("阳江", df[[city_variable]], ignore.case = TRUE)] <- "阳江"
  df$citycode[grep("清远", df[[city_variable]], ignore.case = TRUE)] <- "清远"
  df$citycode[grep("东莞", df[[city_variable]], ignore.case = TRUE)] <- "东莞"
  df$citycode[grep("中山", df[[city_variable]], ignore.case = TRUE)] <- "中山"
  df$citycode[grep("潮州", df[[city_variable]], ignore.case = TRUE)] <- "潮州"
  df$citycode[grep("揭阳", df[[city_variable]], ignore.case = TRUE)] <- "揭阳"
  df$citycode[grep("云浮", df[[city_variable]], ignore.case = TRUE)] <- "云浮"
  df$citycode[grep("南宁", df[[city_variable]], ignore.case = TRUE)] <- "南宁"
  df$citycode[grep("柳州", df[[city_variable]], ignore.case = TRUE)] <- "柳州"
  df$citycode[grep("桂林", df[[city_variable]], ignore.case = TRUE)] <- "桂林"
  df$citycode[grep("梧州", df[[city_variable]], ignore.case = TRUE)] <- "梧州"
  df$citycode[grep("北海", df[[city_variable]], ignore.case = TRUE)] <- "北海"
  df$citycode[grep("防城港", df[[city_variable]], ignore.case = TRUE)] <- "防城港"
  df$citycode[grep("钦州", df[[city_variable]], ignore.case = TRUE)] <- "钦州"
  df$citycode[grep("贵港", df[[city_variable]], ignore.case = TRUE)] <- "贵港"
  df$citycode[grep("玉林", df[[city_variable]], ignore.case = TRUE)] <- "玉林"
  df$citycode[grep("百色", df[[city_variable]], ignore.case = TRUE)] <- "百色"
  df$citycode[grep("贺州", df[[city_variable]], ignore.case = TRUE)] <- "贺州"
  df$citycode[grep("河池", df[[city_variable]], ignore.case = TRUE)] <- "河池"
  df$citycode[grep("来宾", df[[city_variable]], ignore.case = TRUE)] <- "来宾"
  df$citycode[grep("崇左", df[[city_variable]], ignore.case = TRUE)] <- "崇左"
  df$citycode[grep("海口", df[[city_variable]], ignore.case = TRUE)] <- "海口"
  df$citycode[grep("三亚", df[[city_variable]], ignore.case = TRUE)] <- "三亚"
  df$citycode[grep("三沙", df[[city_variable]], ignore.case = TRUE)] <- "三沙"
  df$citycode[grep("儋州", df[[city_variable]], ignore.case = TRUE)] <- "儋州"
  df$citycode[grep("重庆", df[[city_variable]], ignore.case = TRUE)] <- "重庆"
  df$citycode[grep("成都", df[[city_variable]], ignore.case = TRUE)] <- "成都"
  df$citycode[grep("自贡", df[[city_variable]], ignore.case = TRUE)] <- "自贡"
  df$citycode[grep("攀枝花", df[[city_variable]], ignore.case = TRUE)] <- "攀枝花"
  df$citycode[grep("泸州", df[[city_variable]], ignore.case = TRUE)] <- "泸州"
  df$citycode[grep("德阳", df[[city_variable]], ignore.case = TRUE)] <- "德阳"
  df$citycode[grep("绵阳", df[[city_variable]], ignore.case = TRUE)] <- "绵阳"
  df$citycode[grep("广元", df[[city_variable]], ignore.case = TRUE)] <- "广元"
  df$citycode[grep("遂宁", df[[city_variable]], ignore.case = TRUE)] <- "遂宁"
  df$citycode[grep("内江", df[[city_variable]], ignore.case = TRUE)] <- "内江"
  df$citycode[grep("乐山", df[[city_variable]], ignore.case = TRUE)] <- "乐山"
  df$citycode[grep("南充", df[[city_variable]], ignore.case = TRUE)] <- "南充"
  df$citycode[grep("眉山", df[[city_variable]], ignore.case = TRUE)] <- "眉山"
  df$citycode[grep("宜宾", df[[city_variable]], ignore.case = TRUE)] <- "宜宾"
  df$citycode[grep("广安", df[[city_variable]], ignore.case = TRUE)] <- "广安"
  df$citycode[grep("达州", df[[city_variable]], ignore.case = TRUE)] <- "达州"
  df$citycode[grep("雅安", df[[city_variable]], ignore.case = TRUE)] <- "雅安"
  df$citycode[grep("巴中", df[[city_variable]], ignore.case = TRUE)] <- "巴中"
  df$citycode[grep("资阳", df[[city_variable]], ignore.case = TRUE)] <- "资阳"
  df$citycode[grep("贵阳", df[[city_variable]], ignore.case = TRUE)] <- "贵阳"
  df$citycode[grep("六盘水", df[[city_variable]], ignore.case = TRUE)] <- "六盘水"
  df$citycode[grep("遵义", df[[city_variable]], ignore.case = TRUE)] <- "遵义"
  df$citycode[grep("安顺", df[[city_variable]], ignore.case = TRUE)] <- "安顺"
  df$citycode[grep("毕节", df[[city_variable]], ignore.case = TRUE)] <- "毕节"
  df$citycode[grep("铜仁", df[[city_variable]], ignore.case = TRUE)] <- "铜仁"
  df$citycode[grep("昆明", df[[city_variable]], ignore.case = TRUE)] <- "昆明"
  df$citycode[grep("曲靖", df[[city_variable]], ignore.case = TRUE)] <- "曲靖"
  df$citycode[grep("玉溪", df[[city_variable]], ignore.case = TRUE)] <- "玉溪"
  df$citycode[grep("保山", df[[city_variable]], ignore.case = TRUE)] <- "保山"
  df$citycode[grep("昭通", df[[city_variable]], ignore.case = TRUE)] <- "昭通"
  df$citycode[grep("丽江", df[[city_variable]], ignore.case = TRUE)] <- "丽江"
  df$citycode[grep("临沧", df[[city_variable]], ignore.case = TRUE)] <- "临沧"
  df$citycode[grep("普洱", df[[city_variable]], ignore.case = TRUE)] <- "普洱"
  df$citycode[grep("拉萨", df[[city_variable]], ignore.case = TRUE)] <- "拉萨"
  df$citycode[grep("日喀则", df[[city_variable]], ignore.case = TRUE)] <- "日喀则"
  df$citycode[grep("昌都", df[[city_variable]], ignore.case = TRUE)] <- "昌都"
  df$citycode[grep("林芝", df[[city_variable]], ignore.case = TRUE)] <- "林芝"
  df$citycode[grep("山南", df[[city_variable]], ignore.case = TRUE)] <- "山南"
  df$citycode[grep("那曲", df[[city_variable]], ignore.case = TRUE)] <- "那曲"
  df$citycode[grep("西安", df[[city_variable]], ignore.case = TRUE)] <- "西安"
  df$citycode[grep("铜川", df[[city_variable]], ignore.case = TRUE)] <- "铜川"
  df$citycode[grep("宝鸡", df[[city_variable]], ignore.case = TRUE)] <- "宝鸡"
  df$citycode[grep("咸阳", df[[city_variable]], ignore.case = TRUE)] <- "咸阳"
  df$citycode[grep("渭南", df[[city_variable]], ignore.case = TRUE)] <- "渭南"
  df$citycode[grep("延安", df[[city_variable]], ignore.case = TRUE)] <- "延安"
  df$citycode[grep("汉中", df[[city_variable]], ignore.case = TRUE)] <- "汉中"
  df$citycode[grep("榆林", df[[city_variable]], ignore.case = TRUE)] <- "榆林"
  df$citycode[grep("安康", df[[city_variable]], ignore.case = TRUE)] <- "安康"
  df$citycode[grep("商洛", df[[city_variable]], ignore.case = TRUE)] <- "商洛"
  df$citycode[grep("兰州", df[[city_variable]], ignore.case = TRUE)] <- "兰州"
  df$citycode[grep("嘉峪关", df[[city_variable]], ignore.case = TRUE)] <- "嘉峪关"
  df$citycode[grep("金昌", df[[city_variable]], ignore.case = TRUE)] <- "金昌"
  df$citycode[grep("白银", df[[city_variable]], ignore.case = TRUE)] <- "白银"
  df$citycode[grep("天水", df[[city_variable]], ignore.case = TRUE)] <- "天水"
  df$citycode[grep("武威", df[[city_variable]], ignore.case = TRUE)] <- "武威"
  df$citycode[grep("张掖", df[[city_variable]], ignore.case = TRUE)] <- "张掖"
  df$citycode[grep("平凉", df[[city_variable]], ignore.case = TRUE)] <- "平凉"
  df$citycode[grep("酒泉", df[[city_variable]], ignore.case = TRUE)] <- "酒泉"
  df$citycode[grep("庆阳", df[[city_variable]], ignore.case = TRUE)] <- "庆阳"
  df$citycode[grep("定西", df[[city_variable]], ignore.case = TRUE)] <- "定西"
  df$citycode[grep("陇南", df[[city_variable]], ignore.case = TRUE)] <- "陇南"
  df$citycode[grep("西宁", df[[city_variable]], ignore.case = TRUE)] <- "西宁"
  df$citycode[grep("海东", df[[city_variable]], ignore.case = TRUE)] <- "海东"
  df$citycode[grep("海南", df[[city_variable]], ignore.case = TRUE)] <- "海南"
  df$citycode[grep("银川", df[[city_variable]], ignore.case = TRUE)] <- "银川"
  df$citycode[grep("石嘴山", df[[city_variable]], ignore.case = TRUE)] <- "石嘴山"
  df$citycode[grep("吴忠", df[[city_variable]], ignore.case = TRUE)] <- "吴忠"
  df$citycode[grep("固原", df[[city_variable]], ignore.case = TRUE)] <- "固原"
  df$citycode[grep("中卫", df[[city_variable]], ignore.case = TRUE)] <- "中卫"
  df$citycode[grep("乌鲁木", df[[city_variable]], ignore.case = TRUE)] <- "乌鲁木齐"
  df$citycode[grep("克拉玛", df[[city_variable]], ignore.case = TRUE)] <- "克拉玛依"
  df$citycode[grep("吐鲁番", df[[city_variable]], ignore.case = TRUE)] <- "吐鲁番"
  df$citycode[grep("哈密", df[[city_variable]], ignore.case = TRUE)] <- "哈密"
  df$citycode[grep("宜城", df[[city_variable]], ignore.case = TRUE)] <- "宜城"
  df$citycode[grep("喀什", df[[city_variable]], ignore.case = TRUE)] <- "喀什"
  df$citycode[grep("阿克苏", df[[city_variable]], ignore.case = TRUE)] <- "阿克苏"
  df$citycode[grep("楚雄", df[[city_variable]], ignore.case = TRUE)] <- "楚雄"
  df$citycode[grep("大理", df[[city_variable]], ignore.case = TRUE)] <- "大理"
  df$citycode[grep("恩施", df[[city_variable]], ignore.case = TRUE)] <- "恩施土家族苗族自治州"
  df$citycode[grep("锡林郭", df[[city_variable]], ignore.case = TRUE)] <- "锡林郭勒盟"
  df$citycode[grep("玉树", df[[city_variable]], ignore.case = TRUE)] <- "玉树"
  df$citycode[grep("阿拉善", df[[city_variable]], ignore.case = TRUE)] <- "阿拉善"
  df$citycode[grep("阿勒泰", df[[city_variable]], ignore.case = TRUE)] <- "阿勒泰"
  df$citycode[grep("昌吉", df[[city_variable]], ignore.case = TRUE)] <- "昌吉"
  df$citycode[grep("临夏", df[[city_variable]], ignore.case = TRUE)] <- "临夏"
  df$citycode[grep("塔城", df[[city_variable]], ignore.case = TRUE)] <- "塔城"
  df$citycode[grep("文山", df[[city_variable]], ignore.case = TRUE)] <- "文山"
  df$citycode[grep("和田", df[[city_variable]], ignore.case = TRUE)] <- "和田"
  df$citycode[grep("大兴安", df[[city_variable]], ignore.case = TRUE)] <- "大兴安岭"
  df$citycode[grep("延边州", df[[city_variable]], ignore.case = TRUE)] <- "延边"
  df$citycode[grep("凉山", df[[city_variable]], ignore.case = TRUE)] <- "凉山"
  df$citycode[grep("黔西南", df[[city_variable]], ignore.case = TRUE)] <- "黔西南"
  df$citycode[grep("黔南", df[[city_variable]], ignore.case = TRUE)] <- "黔南"
  df$citycode[grep("西双版", df[[city_variable]], ignore.case = TRUE)] <- "西双版纳"
  df$citycode[grep("德宏", df[[city_variable]], ignore.case = TRUE)] <- "德宏傣族景颇族自治州"
  df$citycode[grep("杨凌", df[[city_variable]], ignore.case = TRUE)] <- "咸阳"
  df$citycode[grep("甘南", df[[city_variable]], ignore.case = TRUE)] <- "甘南"
  df$citycode[grep("海北", df[[city_variable]], ignore.case = TRUE)] <- "海北藏族自治州"
  df$citycode[grep("黄南", df[[city_variable]], ignore.case = TRUE)] <- "黄南藏族自治州"
  df$citycode[grep("海西", df[[city_variable]], ignore.case = TRUE)] <- "海西蒙古族藏族自治州"
  df$citycode[grep("巴音郭楞", df[[city_variable]], ignore.case = TRUE)] <- "巴音郭楞"
  df$citycode[grep("一师", df[[city_variable]], ignore.case = TRUE)] <- 660100
  df$citycode[grep("二师", df[[city_variable]], ignore.case = TRUE)] <- 660200
  df$citycode[grep("三师", df[[city_variable]], ignore.case = TRUE)] <- 660300
  df$citycode[grep("五师", df[[city_variable]], ignore.case = TRUE)] <- 660500
  df$citycode[grep("六师", df[[city_variable]], ignore.case = TRUE)] <- 660600
  df$citycode[grep("七师", df[[city_variable]], ignore.case = TRUE)] <- 660700
  df$citycode[grep("八师", df[[city_variable]], ignore.case = TRUE)] <- 660800
  df$citycode[grep("十师", df[[city_variable]], ignore.case = TRUE)] <- 661000
  df$citycode[grep("工师", df[[city_variable]], ignore.case = TRUE)] <- 661100
  df$citycode[grep("十二师", df[[city_variable]], ignore.case = TRUE)] <- 661200
  df$citycode[grep("十三师", df[[city_variable]], ignore.case = TRUE)] <- 661300
  df$citycode[grep("十四师", df[[city_variable]], ignore.case = TRUE)] <- 661400
  df$citycode[grep("兴安盟", df[[city_variable]], ignore.case = TRUE)] <- "兴安盟"
  df$citycode[grep("大兴安岭", df[[city_variable]], ignore.case = TRUE)] <- "大兴安岭"
  df$citycode[grep("济源市", df[[city_variable]], ignore.case = TRUE)] <- "济源"
  df$citycode[grep("神农架", df[[city_variable]], ignore.case = TRUE)] <- "神农架"
  df$citycode[grep("湘西", df[[city_variable]], ignore.case = TRUE)] <- "湘西土家族苗族自治州"
  df$citycode[grep("黔东南", df[[city_variable]], ignore.case = TRUE)] <- "黔东南苗族侗族自治州"
  df$citycode[grep("红河", df[[city_variable]], ignore.case = TRUE)] <- "红河哈尼族彝族自治州"
  df$citycode[grep("怒江", df[[city_variable]], ignore.case = TRUE)] <- "怒江傈僳族自治州"
  df$citycode[grep("迪庆", df[[city_variable]], ignore.case = TRUE)] <- "迪庆藏族自治州"
  df$citycode[grep("博尔塔拉", df[[city_variable]], ignore.case = TRUE)] <- "博尔塔拉蒙古自治州"
  df$citycode[grep("克孜勒", df[[city_variable]], ignore.case = TRUE)] <- "克孜勒苏柯尔克孜自治州"
  df$citycode[grep("和田", df[[city_variable]], ignore.case = TRUE)] <- "和田"
  df$citycode[grep("伊犁", df[[city_variable]], ignore.case = TRUE)] <- "伊犁哈萨克自治州"
  df$citycode[grep("绥芬河", df[[city_variable]], ignore.case = TRUE)] <- "牡丹江"
  df$citycode[grep("果洛", df[[city_variable]], ignore.case = TRUE)] <- "果洛藏族自治州"
  df$citycode[grep("四师", df[[city_variable]], ignore.case = TRUE)] <- 660400
  df$citycode[grep("九师", df[[city_variable]], ignore.case = TRUE)] <- 660900
  df$citycode[grep("永城", df[[city_variable]], ignore.case = TRUE)] <- "商丘"
  df$citycode[grep("潜江", df[[city_variable]], ignore.case = TRUE)] <- "潜江"
  df$citycode[grep("阿坝", df[[city_variable]], ignore.case = TRUE)] <- "阿坝藏族羌族自治州"
  df$citycode[grep("甘孜", df[[city_variable]], ignore.case = TRUE)] <- "甘孜藏族自治州"
  df$citycode[grep("博州", df[[city_variable]], ignore.case = TRUE)] <- "博尔塔拉蒙古自治州"
  df$citycode[grep("抚远县", df[[city_variable]], ignore.case = TRUE)] <- "佳木斯"
  df$citycode[grep("平潭综合实", df[[city_variable]], ignore.case = TRUE)] <- "福州"
  df$citycode[grep("贵安新区", df[[city_variable]], ignore.case = TRUE)] <- "贵阳"
  df$citycode[grep("平潭综合实验区", df[[city_variable]], ignore.case = TRUE)] <- "福州"
  df$citycode[grep("仙桃", df[[city_variable]], ignore.case = TRUE)] <- "仙桃"
  df$citycode[grep("梅河口", df[[city_variable]], ignore.case = TRUE)] <- "通化"
  df$citycode[grep("西咸新区", df[[city_variable]], ignore.case = TRUE)] <- "西安"
  df$citycode[grep("天门", df[[city_variable]], ignore.case = TRUE)] <- "天门"

  # 将更新后的数据框保存回原数据框
  assign(df_name, df, envir = .GlobalEnv)
  
  # 返回更新后的数据框
  return(df)
}

